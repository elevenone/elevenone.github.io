<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- <meta http-equiv="Content-Security-Policy" content="none" /> -->

    <title>Vanilla Router</title>
    <link rel="stylesheet" href="./rsrc/css/reset.css" />
    <link rel="stylesheet" href="./ui/main.css" />
</head>

<body>

      
      <canvas id="canvas" style="width: 300px; height: 300px;" width="360" height="360"></canvas>
      


    <main>

        <header>
            <nav>
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/#products">Products</a></li>
                    <li><a href="/#about">About</a></li>
                    <li><a href="/#missing">missing</a></li>
                    <li><a href="/#missing1">missing1</a></li>
                    <li><a href="/#error">error</a></li>
                    <li><a href="/#zorro">zorro</a></li>
                    <li><a href="http://www.sandorzsolt.hu">sandorzsolt</a></li>
                <!--
                    <hr>
                    <li><a href="/products">Products</a></li>
                    <li><a href="/about">About</a></li>
                    <li><a href="/missinghistory">missinghistory route</a></li>
                -->
                </ul>
            </nav>
        </header>

        <section>

        </section>

        <canvas id="canvas" style="width: 300px; height: 300px;" width="360" height="360"></canvas>

    </main>

    <footer>
        <link rel="html" href="./partial.html" />
    </footer>

    



<script defer type="module" src="./rsrc/js/index.js"></script>
<script src="./ui/simplex-noise.js"></script>


<script>
// vars
// const width = Math.min(window.innerWidth, window.innerHeight) * .8;
// const height = width;
const width = 300;
const height = 300;
const cell = 10;
const simplex = new SimplexNoise();
const loop = 0;

class Raf {
  constructor() {
    this.raf();
  }
  raf() {
    if (this.onRaf) {
      window.requestAnimationFrame(() => {
        const o = {};
        o.time = window.performance.now() / 1000;
        o.playhead = o.time % loop / loop;
        this.raf();
        this.onRaf(o);
      });
    }
  }}

  //
class Canvas extends Raf {
  constructor(obj) {
    super();
    this.canvas = document.getElementById(obj.id);
    this.ctx = this.canvas.getContext('2d');
    // this.resize();
    this.events();
  }

  resize() {
    this.dpr = window.devicePixelRatio;
    this.canvas.style.width = `${width}px`;
    this.canvas.style.height = `${height}px`;
    this.canvas.width = width * this.dpr;
    this.canvas.height = height * this.dpr;
    this.ctx = this.canvas.getContext('2d');
    this.ctx.scale(this.dpr, this.dpr);
  }

  events() {
    window.addEventListener('resize', this.resize);
  }

  clear() {
    this.ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
  }

  onRaf() {
    this.clear();
  }}

  //
class Fur extends Raf {
  constructor(obj) {
    super();
    Object.assign(this, obj);
    this.draw();
  }

  draw(playhead, time) {
    this.ctx.save();
    this.ctx.translate(this.x, this.y);
    const n = this.simplex.noise3D(time * 0.1 + this.x * 0.002, -time * 0.2 + this.y * 0.002, time * 0.3);

    this.ctx.fillStyle = 'white';

    const t = Math.round(22 * ((n + 2) * .5)) % 10;

    for (let i = 0; i < t; i++) {
      this.ctx.fillRect(Math.random() * cell, Math.random() * 30, 1, 1);
    }
    this.ctx.fill();
    this.ctx.restore();
  }

  onRaf({ playhead, time }) {
    this.draw(playhead, time);
  }}

// init
const canvas = new Canvas({
  id: 'canvas' });

for (let y = 0; y < height; y += cell) {
  for (let x = 0; x < width; x += cell) {
    const i = y * width / cell + x / cell;
    new Fur({
      ctx: canvas.ctx,
      x: x,
      y: y,
      id: i,
      simplex: simplex });
  }
}
</script>



</body>

</html>